FROM us.gcr.io/surreal-dev-188523/surreal-base-gpu-new:latest

# Arrange these dependencies to heuristically minimize number of layers to build

RUN echo cache bust 231
RUN pip install \
	git+https://f446c0601e01c03d6b85891051b67e9007258af4@github.com/SurrealAI/Tensorplex.git \ 
	git+https://f446c0601e01c03d6b85891051b67e9007258af4@github.com/SurrealAI/BeneDict.git \
	git+https://f446c0601e01c03d6b85891051b67e9007258af4@github.com/SurrealAI/nanolog.git

COPY torchx /mylibs/torchx
RUN pip install -e /mylibs/torchx

COPY mujoco /mylibs/mujoco
RUN pip install -e /mylibs/mujoco

COPY surreal /mylibs/surreal
RUN pip install -e /mylibs/surreal

RUN pip install easydict
ENTRYPOINT ["/mylibs/surreal/container/entry.py"]